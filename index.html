<!DOCTYPE html>
    <html lang="ja">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>米国株 テーマランキング</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&family=DM+Sans:wght@500;600;700&display=swap" rel="stylesheet">
        <style>
            :root {
                --bg-color: #ffffff;
                --item-border: #f0f0f0;
                --text-main: #222222;
                --text-sub: #666666;
                --text-muted: #999999;
                
                /* 上位1-3位: グリーン系 */
                --rank-top: linear-gradient(135deg, #10b981 0%, #34d399 100%);
                --rank-top-shadow: rgba(16, 185, 129, 0.4);
                
                /* 通常ランク: 紫系 */
                --rank-normal: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                
                /* 下位3位: 赤系 */
                --rank-bottom: linear-gradient(135deg, #ef4444 0%, #f87171 100%);
                --rank-bottom-shadow: rgba(239, 68, 68, 0.4);
                
                /* パフォーマンス色 */
                --positive: #00875a;
                --negative: #de350b;
                
                /* S&P500 特別色 */
                --sp500-bg: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
                --sp500-border: #f59e0b;
            }

            * {
                box-sizing: border-box;
            }

            body { 
                font-family: 'Noto Sans JP', 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
                background-color: var(--bg-color); 
                margin: 0; 
                padding: 0; 
                color: var(--text-main); 
                padding-bottom: 80px;
                -webkit-font-smoothing: antialiased;
            }
            
            header { 
                background: #fff;
                position: sticky; 
                top: 0; 
                z-index: 100; 
                padding: 15px 20px 12px 20px; 
                box-shadow: 0 2px 10px rgba(0,0,0,0.06);
            }
            
            h1 { 
                font-size: clamp(1rem, 5vw, 1.4rem); 
                margin: 0 auto 8px auto; 
                text-align: center; 
                font-weight: 700;
                letter-spacing: 0.5px;
                color: #111;
                white-space: nowrap;
                text-shadow: 
                    0 0 15px rgba(255,255,255,0.8),
                    0 0 30px rgba(255,255,255,0.5),
                    0 1px 3px rgba(0,0,0,0.1);
            }
            
            /* 期間セレクター */
            .period-selector { 
                display: flex; 
                justify-content: center; 
                gap: 4px;
                flex-wrap: nowrap;
                margin: 12px 0 8px 0;
            }
            
            .period-btn { 
                padding: 6px 10px;
                border: none;
                background: linear-gradient(135deg, #e8e8e8 0%, #f5f5f5 100%);
                border-radius: 25px; 
                cursor: pointer; 
                font-size: 0.75rem;
                font-weight: 500;
                transition: all 0.3s ease; 
                color: #666;
                box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                white-space: nowrap;
            }
            
            .period-btn.active { 
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
                color: #fff; 
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
                transform: translateY(-1px);
            }
            
            .period-btn:hover:not(.active) { 
                background: linear-gradient(135deg, #ddd 0%, #e8e8e8 100%); 
                transform: translateY(-1px);
                box-shadow: 0 3px 8px rgba(0,0,0,0.1);
            }
            
            .header-update-info {
                text-align: center;
                font-size: 0.7rem;
                color: #aaa;
                margin-top: 8px;
            }
            
            /* パフォーマンス表示ヘッダー - ヘッダー内に配置 */
            .perf-header {
                display: flex;
                align-items: center;
                padding: 10px 16px 6px;
                max-width: 800px;
                margin: 8px auto 0;
                background: #f8f8f8;
                border-radius: 8px 8px 0 0;
            }
            
            .perf-header-left {
                flex: 1;
                font-size: 0.65rem;
                font-weight: 600;
                color: var(--text-muted);
                min-width: 80px;
            }
            
            .perf-header-right {
                display: flex;
                gap: 4px;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .perf-header-right::-webkit-scrollbar {
                display: none;
            }
            
            .perf-header-item {
                text-align: center;
                min-width: 44px;
                font-size: 0.55rem;
                font-weight: 600;
                color: var(--text-muted);
                flex-shrink: 0;
                padding: 0 2px;
            }
            
            .perf-header-item.active {
                color: #667eea;
                font-weight: 700;
                min-width: 56px;
            }
            
            .list-container { 
                max-width: 800px; 
                margin: 0 auto;
            }
            
            /* テーマアイテム */
            .theme-item { 
                border-bottom: 1px solid var(--item-border); 
                padding: 10px 16px; 
                display: flex; 
                align-items: center;
                justify-content: space-between;
                gap: 8px; 
                background: #ffffff;
                transition: background 0.2s ease;
            }
            
            .theme-item:nth-child(even) { 
                background: linear-gradient(135deg, #fafafa 0%, #f7f7f7 100%);
            }
            
            .theme-item:hover {
                background: linear-gradient(135deg, #f0f4ff 0%, #e8ecf8 100%);
            }
            
            /* S&P500 特別スタイル */
            .theme-item.sp500 {
                background: var(--sp500-bg);
                border-left: 3px solid var(--sp500-border);
            }
            
            .theme-item.sp500:hover {
                background: linear-gradient(135deg, #fef9c3 0%, #fde047 100%);
            }
            
            .item-left {
                display: flex;
                align-items: center;
                gap: 10px;
                flex: 1;
                min-width: 0;
                overflow: hidden;
            }
            
            /* ランクバッジ */
            .rank { 
                font-size: 0.65rem;
                color: #fff; 
                font-weight: 600;
                background: var(--rank-normal);
                width: 1.6em;
                height: 1.6em;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-shrink: 0;
            }
            
            /* 上位1-3位: グリーン系 */
            .rank.top {
                background: var(--rank-top);
                box-shadow: 0 2px 6px var(--rank-top-shadow);
            }
            
            /* 下位3位: 赤系 */
            .rank.bottom {
                background: var(--rank-bottom);
                box-shadow: 0 2px 6px var(--rank-bottom-shadow);
            }
            
            .theme-name { 
                font-size: 0.85rem; 
                font-weight: 600; 
                color: var(--text-main);
                line-height: 1.35;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            
            /* パフォーマンスコンテナ */
            .perf-container { 
                display: flex;
                align-items: center;
                gap: 4px;
                flex-shrink: 0;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .perf-container::-webkit-scrollbar {
                display: none;
            }
            
            .perf-item {
                text-align: center;
                min-width: 44px;
                flex-shrink: 0;
                padding: 0 2px;
            }
            
            .perf-item.active {
                min-width: 56px;
            }
            
            .perf-value { 
                font-size: 0.55rem;
                font-weight: 500;
                color: var(--text-muted);
                font-family: 'DM Sans', sans-serif;
            }
            
            .perf-value.active {
                font-size: 1rem;
                font-weight: 700;
            }
            
            .perf-value.perf-up { color: var(--positive); }
            .perf-value.perf-down { color: var(--negative); }
            
            /* 全て表示ボタン行 */
            .expand-row {
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 12px 16px;
                background: linear-gradient(180deg, #f8f9fc 0%, #eef1f6 100%);
                border-bottom: 1px solid var(--item-border);
            }
            
            .expand-btn {
                padding: 8px 24px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: #fff;
                border: none;
                border-radius: 20px;
                font-size: 0.8rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.2s ease;
                box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
            }
            
            .expand-btn:hover {
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
            }
            
            /* モバイル */
            @media (max-width: 600px) {
                .theme-name {
                    font-size: 0.78rem;
                }
                
                .perf-item:not(.active) {
                    min-width: 38px;
                }
                
                .perf-header-item:not(.active) {
                    min-width: 38px;
                }
            }
            
            /* PC向け */
            @media (min-width: 600px) {
                .period-btn {
                    padding: 8px 16px;
                    font-size: 0.85rem;
                }
                
                .theme-name {
                    font-size: 1.05rem;
                    white-space: normal;
                    overflow: visible;
                    text-overflow: unset;
                }
                
                .perf-value {
                    font-size: 0.6rem;
                }
                
                .perf-value.active {
                    font-size: 1.15rem;
                }
                
                .rank {
                    font-size: 0.75rem;
                    width: 1.8em;
                    height: 1.8em;
                }
                
                .perf-header-item {
                    min-width: 50px;
                    font-size: 0.6rem;
                }
                
                .perf-header-item.active {
                    min-width: 64px;
                }
                
                .perf-item {
                    min-width: 50px;
                }
                
                .perf-item.active {
                    min-width: 64px;
                }
            }
        </style>
    </head>
    <body>
        <header>
            <h1>米国株 テーマランキング</h1>
            <div class="period-selector">
                <button class="period-btn" data-period="1日">1日</button>
                <button class="period-btn" data-period="5日">5日</button>
                <button class="period-btn active" data-period="10日">10日</button>
                <button class="period-btn" data-period="30日">30日</button>
                <button class="period-btn" data-period="半年">半年</button>
                <button class="period-btn" data-period="1年">1年</button>
            </div>
            <div class="header-update-info" id="update-info"></div>
            <div class="perf-header">
                <div class="perf-header-left">テーマ</div>
                <div class="perf-header-right">
                    <div class="perf-header-item" data-period="1日">1日</div>
                    <div class="perf-header-item" data-period="5日">5日</div>
                    <div class="perf-header-item active" data-period="10日">10日</div>
                    <div class="perf-header-item" data-period="30日">30日</div>
                    <div class="perf-header-item" data-period="半年">半年</div>
                    <div class="perf-header-item" data-period="1年">1年</div>
                </div>
            </div>
        </header>
        
        <div id="app" class="list-container"></div>
        
        <script>
            const csvRaw = `テーマ,1日,5日,10日,3ヶ月,半年,1年
グーグル「Gemini3」「TPU」でAI覇権,0.008606431385602242,0.08184418120581505,0.11948918711331835,0.3031303871912552,0.7015631619500655,0.7160321818947755
AI利用恩恵により株価上昇,0.014622745118110014,0.012094136589298365,0.018244946230594472,0.10711279874148905,0.21868141240515726,0.2835409375345581
AI利用基盤ソフトウェア,-0.024981649454749677,0.017341058387165376,0.3237926591209874,0.457094090317532,0.7576026399954903,0.4099050034394447
エヌビディア 800V直流,0.0014999499676322525,0.03905997523446403,0.09291050001624712,0.18589240970862675,0.3800772408241717,0.25619026369533704
データセンター：光インターコネクト,0.01834911066774203,0.09018182788444573,0.14311729581380694,0.2878265344116224,0.7237846973704758,0.47003597712672796
データセンター：過剰投資懸念,-0.11135534415221038,-0.07385341154212843,-0.03151349776683021,-0.3194418529902169,-0.0029621106087581728,0.12260813266370296
OpenAI関連,-0.050147935893651074,-0.03267878406999469,-0.014981094432874653,-0.18875434168277783,0.03103839797726904,0.14372133761329553
オートメーション,0.012962008865213148,0.0318180096849785,0.06816378493387898,0.3389139304504085,0.474209392331449,0.5453902752610766
銀鉱山,0.07156512872801435,0.12444603833056989,0.16850074230688006,0.3654617727876528,0.8599461763705745,1.6297843079077001
金鉱山,0.03836182128860455,0.054547830031192346,0.040466787063299536,0.1845376839151156,0.5455715396859813,1.0485751324834167
銅鉱山,0.03058556058322104,0.06654623890777445,0.12543216741330143,0.2485787859278128,0.3856548659506298,0.33113679004263186
製薬大手,0.01060431285246155,-0.011915492791142346,-0.029701462359956743,0.14756586074034495,0.18667236924523278,0.20910472937929558
エアライン,0.007676238512153821,0.06555568026068115,0.10400437962048681,0.1722544929037675,0.46753273876029033,0.10728855581350571
データセンター電力：独立電源,0.006720938836908719,0.03129416768086135,0.0872662550902168,0.33494296403386703,0.8507176326571662,0.9028970432165786
データセンター電力：独立系発電,0.014561980619716808,-0.009950247893939501,-0.016008774816150928,0.023672527650150377,0.11424084562306058,0.16956262267242028
データセンター電力：規制下発電,0.0005361283491269742,-0.025321841328805994,-0.06780983395633322,-0.0219326990115416,0.018483841951884683,0.15829406053925577
データセンター：ストレージ,0.03178837145219071,0.14579370958301707,0.13728712317917058,0.7932869076806603,2.0408895123009945,2.3866608169457817
ネオクラウド,0.006843952634140837,-0.009418240791816301,0.0931592821133822,0.2501944778755336,1.100865467941524,0.4526540791004279
量子コンピュータ,0.02246253426285394,-0.06048057653517458,0.10194442220687971,0.24758248753477963,0.39135055905293625,0.4912842842452161
データセンター：ラック内接続,0.003874105509247938,0.04278712828023612,0.06742066254413315,0.12948401758993588,0.5354211168199916,0.4958768113632104
半導体設計ソフト・ライセンス,-0.007421413797082832,0.012266614493815053,0.08390790560379124,-0.07229975776829645,0.12979494038246897,0.05469181037352633
ハイパースケーラー カスタムAI半導体,-0.017073846967264328,0.042079420553988056,0.061352147380032473,0.19846225701604836,0.4605543904562235,0.6264476983421807
エヌビディア次世代電源アーキテクチャ,6.604947105381953e-05,0.026883128073541318,0.09625533976242195,0.02713504532028299,0.07035337149666354,-0.00172870918231538
パワー半導体：GaN,-0.0016292642644318844,-0.003795476994119751,0.08051738693464716,-0.019404701372555233,-0.09866323772237628,-0.24607441954737053
パワー半導体：SiC,0.016069580375138504,0.049596688690900725,0.20639794702444259,0.07984959024204685,0.1834247035338783,0.2892851611574603
パワー半導体：総合,0.0014999499676322525,0.013725987529520145,0.07280068208286461,0.0890993307764063,0.1290098482911073,0.19332239004666807
データセンター：サーバー受託製造,0.0070610823745183016,0.11079255013160982,0.16042857406848166,0.28435868634726047,0.9058141933789563,1.3042601275615144
データセンター：サーバーOEM,-0.021596801275751365,0.033828694547007876,0.08922931399799516,0.05870785808299339,0.31224800495376925,0.19049325132250994
ハイパースケーラー,-0.00628757115053491,0.007961582321066585,0.011208982031532644,-0.010249294278784737,0.12460371085914468,0.06302094629189336
スマートグラス,-0.005502614153184315,0.009841134610856228,0.03996290602218466,0.09260822488521714,0.27818876672423,0.367578502498368
SP500,0.002079350841514227,0.006399170798031539,0.012974489731924832,0.04810085203697967,0.14155557702267418,0.13425124239381803
`;
            let currentPeriod = '10日';
            let isExpanded = false;
            
            const periodOrder = ['1日', '5日', '10日', '30日', '半年', '1年'];

            function parseCSV(csvText) {
                const lines = csvText.trim().split('\n');
                const data = [];
                
                const headers = lines[0].split(',').map(h => h.trim());
                
                let themeIdx = 0;
                let idx1d = headers.findIndex(h => h === '1日');
                let idx5d = headers.findIndex(h => h === '5日');
                let idx10d = headers.findIndex(h => h === '10日');
                let idx30d = headers.findIndex(h => h === '3ヶ月' || h === '30日');
                let idx6m = headers.findIndex(h => h === '半年');
                let idx1y = headers.findIndex(h => h === '1年');
                
                if (idx1d === -1) idx1d = 1;
                if (idx5d === -1) idx5d = 2;
                if (idx10d === -1) idx10d = 3;
                if (idx30d === -1) idx30d = 4;
                if (idx6m === -1) idx6m = 5;
                if (idx1y === -1) idx1y = 6;
                
                for (let lineIdx = 1; lineIdx < lines.length; lineIdx++) {
                    const line = lines[lineIdx];
                    if (!line.trim()) continue;
                    
                    const cols = line.split(',');
                    if (cols.length < 4) continue;
                    
                    let themeName = cols[themeIdx].trim();
                    if (!themeName) continue;
                    
                    const isSP500 = themeName === 'SP500' || themeName === 'S&P500';
                    if (isSP500) {
                        themeName = 'S&P500';
                    }
                    
                    data.push({
                        name: themeName,
                        isSP500: isSP500,
                        '1日': parseFloat(cols[idx1d]) || 0,
                        '5日': parseFloat(cols[idx5d]) || 0,
                        '10日': parseFloat(cols[idx10d]) || 0,
                        '30日': parseFloat(cols[idx30d]) || 0,
                        '半年': parseFloat(cols[idx6m]) || 0,
                        '1年': parseFloat(cols[idx1y]) || 0
                    });
                }
                
                return data;
            }

            function sortByPeriod(themes, period) {
                return [...themes].sort((a, b) => b[period] - a[period]);
            }

            function getRankClass(index, total) {
                if (index < 3) return 'rank top';
                if (index >= total - 3) return 'rank bottom';
                return 'rank';
            }

            function formatPerf(value) {
                const isPositive = value >= 0;
                const sign = isPositive ? '+' : '';
                return `${sign}${(value * 100).toFixed(1)}%`;
            }

            function updatePerfHeader() {
                document.querySelectorAll('.perf-header-item').forEach(item => {
                    if (item.dataset.period === currentPeriod) {
                        item.classList.add('active');
                    } else {
                        item.classList.remove('active');
                    }
                });
            }

            function createThemeItem(theme, index, total) {
                let itemClass = 'theme-item';
                if (theme.isSP500) itemClass += ' sp500';
                
                let rankHtml = '';
                if (!theme.isSP500) {
                    const rankClass = getRankClass(index, total);
                    rankHtml = `<span class="${rankClass}">${index + 1}</span>`;
                }
                
                let perfHtml = '';
                periodOrder.forEach(period => {
                    const value = theme[period];
                    const isActive = period === currentPeriod;
                    const isPositive = value >= 0;
                    
                    let perfClass = 'perf-value';
                    if (isActive) {
                        perfClass += ' active';
                        perfClass += isPositive ? ' perf-up' : ' perf-down';
                    }
                    
                    let itemCls = 'perf-item';
                    if (isActive) itemCls += ' active';
                    
                    perfHtml += `
                        <div class="${itemCls}">
                            <div class="${perfClass}">${formatPerf(value)}</div>
                        </div>
                    `;
                });
                
                const item = document.createElement('div');
                item.className = itemClass;
                item.innerHTML = `
                    <div class="item-left">
                        ${rankHtml}
                        <span class="theme-name">${theme.name}</span>
                    </div>
                    <div class="perf-container">
                        ${perfHtml}
                    </div>
                `;
                
                return item;
            }

            function renderList() {
                const rawThemes = parseCSV(csvRaw);
                const sorted = sortByPeriod(rawThemes, currentPeriod);
                const total = sorted.length;
                
                // S&P500のインデックスを取得
                const sp500Index = sorted.findIndex(t => t.isSP500);
                
                updatePerfHeader();
                
                const container = document.getElementById('app');
                container.innerHTML = '';
                
                if (sorted.length === 0) {
                    container.innerHTML = '<div style="text-align:center;padding:40px;color:#999;">データがありません</div>';
                    return;
                }
                
                if (isExpanded) {
                    sorted.forEach((theme, index) => {
                        container.appendChild(createThemeItem(theme, index, total));
                    });
                } else {
                    // 折りたたみ表示: 上位5件 + S&P500 + 全て表示ボタン + 下位5件
                    const topCount = 5;
                    const bottomCount = 5;
                    
                    // 表示するインデックスを決定
                    let topIndices = [];
                    let bottomIndices = [];
                    
                    // 上位5件
                    for (let i = 0; i < Math.min(topCount, total); i++) {
                        topIndices.push(i);
                    }
                    
                    // S&P500が上位5件に含まれていなければ追加
                    if (sp500Index !== -1 && !topIndices.includes(sp500Index)) {
                        topIndices.push(sp500Index);
                        topIndices.sort((a, b) => a - b);
                    }
                    
                    // 下位5件（上位と重複しないもの）
                    for (let i = Math.max(0, total - bottomCount); i < total; i++) {
                        if (!topIndices.includes(i)) {
                            bottomIndices.push(i);
                        }
                    }
                    
                    // 上位を表示
                    topIndices.forEach(idx => {
                        container.appendChild(createThemeItem(sorted[idx], idx, total));
                    });
                    
                    // 全て表示ボタン（中間に省略があれば）
                    if (bottomIndices.length > 0 && total > topIndices.length + bottomIndices.length) {
                        const expandRow = document.createElement('div');
                        expandRow.className = 'expand-row';
                        expandRow.innerHTML = `<button class="expand-btn" id="expand-btn">全て表示</button>`;
                        container.appendChild(expandRow);
                        
                        document.getElementById('expand-btn').addEventListener('click', () => {
                            isExpanded = true;
                            renderList();
                        });
                    }
                    
                    // 下位を表示
                    bottomIndices.forEach(idx => {
                        container.appendChild(createThemeItem(sorted[idx], idx, total));
                    });
                }
                
                // 更新日時
                const now = new Date();
                const updateInfo = document.getElementById('update-info');
                updateInfo.textContent = `最終更新: ${now.getFullYear()}/${String(now.getMonth()+1).padStart(2,'0')}/${String(now.getDate()).padStart(2,'0')} ${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;
            }

            document.querySelectorAll('.period-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentPeriod = this.dataset.period;
                    isExpanded = false; // 期間切替時に折りたたむ
                    renderList();
                });
            });
            
            renderList();
        </script>
    </body>
    </html>